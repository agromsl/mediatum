<tal:block metal:define-macro="edit_news">
    <script tal:content="python:'\nvar nodeid='+ids+';'"> </script>
    <div id="content" tal:content="raw content">
    </div>
</tal:block>

<metal:block metal:define-macro="news_modify">
    <form method="post" id="addform" style="border:1px solid silver">
        <h2 tal:condition="python:operation=='edit'" i18n:translate="edit_news_editentry">TEXT</h2>
        <h2 tal:condition="python:operation=='add'" i18n:translate="edit_news_addentry">TEXT</h2>
        <script type="text/javascript" src="/ckeditor/ckeditor.js"> </script>
        <input type="hidden" name="news_id" tal:attributes="value python:item.getId()"/>
        <div style="padding-right:20px">
            <p><tal:block i18n:translate="edit_news_entrytype"/>:<br/>
                <select name="news_type">
                    <option tal:repeat="newstype newstypes" tal:content="newstype" tal:attributes="value newstype; selected python:{'True':'selected', 'False':None}[str(newstype==item.getType())]"/>
                </select>
            </p>
        </div>

        <div style="float:left;padding-right:20px">
            <p>
                <tal:block i18n:translate="edit_news_datefrom"/><br/>
                <input tal:attributes="value python:item.getDateStart(d_format)" type="text" name="news_datefrom" maxlength="10"/><small>(<tal:block tal:replace="d_format"/>)</small>
            </p>
        </div>
        <div style="float:left;padding-right:20px">
            <p>
                <tal:block i18n:translate="edit_news_dateuntil"/><br/>
                <input tal:attributes="value python:item.getDateEnd(d_format)" type="text" name="news_dateuntil" maxlength="10"/><small>(<tal:block tal:replace="d_format"/>)</small>
            </p>
        </div>
        <div style="float:left;padding-right:20px">
            <p>
                <br/>
                <input type="checkbox" name="news_visible" value="visible" tal:attributes="checked python:{'1':'checked', '0':None}[str(item.getVisible())]">
                <tal:block i18n:translate="edit_news_visible"/>
            </p>
        </div>
        <div style="clear:both"/>
        <p>
            <tal:block i18n:translate="edit_news_messagedate"/>:<br/>
            <input tal:attributes="value python:item.getDate(d_format)" type="text" name="news_date" maxlength="10"/><small>(<tal:block tal:replace="d_format"/>)</small>
        </p>
        <p>
            <tal:block i18n:translate="edit_news_title"/>:<br/>
            <input tal:attributes="value python:item.getTitle()" type="text" name="news_title" maxlength="100" style="width:500px"/>
        </p>
        <script tal:content="python:'var currentnodeid = '+node.id+';\nvar language = \''+language+'\';\n'"> </script>
        <textarea id="news_text" name="news_text" tal:content="python:item.getMessage()"> </textarea>
        <script type="text/javascript">
            CKEDITOR.replace( 'news_text' , {
                    language : language,
                    filebrowserBrowseUrl : '/edit/edit_content/'+currentnodeid+'/startpages/filebrowser',
                    filebrowserUploadUrl : '/edit/edit_content/'+currentnodeid+'/startpages/filebrowser',
                    filebrowserImageUploadUrl : '/edit/edit_content/'+currentnodeid+'/startpages/htmlupload',
                    filebrowserImageBrowserUrl : '/edit/edit_content/'+currentnodeid+'/startpages/filebrowser',
                    currentNodeId : currentnodeid,
                    height: '80px',
                    width: '600px',
                    skin: 'office2003' });
        </script>
        <small tal:content="python:item.getCreated(d_formatlong)"/>
        <p>
            <button type="submit" name="save" style="margin-right:30px" i18n:translate="edit_news_save">TEXT</button>
            <button type="submit" name="cancel" i18n:translate="edit_news_cancel">TEXT</button>
        </p>
    </form>
</metal:block>

<metal:block metal:define-macro="news_content">
    <style type="text/css">
        #msgtable{
            border:1px solid silver; border-width:1px 1px 0px 1px
        }
        #msgtable input{
            background-color:transparent; margin:1px; border-width:0px
        }
        #msgtable input:hover{
            border-width:0px
        }
        #msgtable th{
            background-color:#d8d8d8; padding:3px 5px 2px 3px; border-bottom:1px solid silver; font-variant:small-caps
        }
        #msgtable tr{
            border:1px solid silver
        }
        #msgtable td{
            vertical-align:middle; padding:2px;border-bottom:1px solid silver
        }
        #msgtable tr:hover{
            background-color:silver
        }
        #msgtable a{
            color:#000000; padding:1px;margin:0px
        }
        td.silver{
            background-color:#efefef
        }
    </style>
    <form method="post">
        <h2 i18n:translate="edit_news_overviewheader">TEXT</h2>
        <table id="msgtable" cellpadding="0px" cellspacing="0px">
            <thead>
                <tr>
                    <th i18n:translate="edit_news_start">TEXT</th>
                    <th>&nbsp;</th>
                    <th i18n:translate="edit_news_end">TEXT</th>
                    <th i18n:translate="edit_news_date">TEXT</th>
                    <th i18n:translate="edit_news_active">TEXT</th>
                    <th i18n:translate="edit_news_visible">TEXT</th>
                    <th i18n:translate="edit_news_type" style="width:60px">TEXT</th>
                    <th i18n:translate="edit_news_title">TEXT</th>
                    <th i18n:translate="edit_news_message">TEXT</th>
                    <th><input name="add_item" i18n:attributes="title edit_news_addtitle; alt edit_news_addtitle" type="image" src="/img/install.png"/></th>
                </tr>
            </thead>
            <tbody>
                <tal:block tal:repeat="item items">
                <tr tal:define="cssclass python:items.index(item)%2 and 'silver' or 'norm'" tal:attributes="class cssclass">
                    <td tal:content="python:item.getDateStart(d_format)+'&nbsp;'">TEXT</td>
                    <td>-</td>
                    <td tal:content="python:item.getDateEnd(d_format)+'&nbsp;'">TEXT</td>
                    <td tal:content="python:item.getDate(d_format)+'&nbsp;'"></td>
                    <td style="text-align:center">
                        <img tal:condition="python:item.getVisible()=='1'" src="/img/haken.gif"/>
                        &nbsp;
                    </td>
                    <td style="text-align:center"><img tal:condition="python:item.isVisible()" i18n:attributes="title edit_news_visible" src="/img/visible.gif"/>&nbsp;</td>
                    <td tal:content="python:item.getType()"></td>
                    <td tal:content="python:item.getTitle()"></td>
                    <td tal:content="raw python:item.getMessageShort(40)"></td>
                    <td>
                        <input tal:attributes="name python:'edit_'+item.id" i18n:attributes="title edit_news_edittitle; alt edit_new_edittitle" type="image" src="/img/edit.png"/> 
                        <input tal:attributes="name python:'delete_'+item.id; onclick python:'return questionDelName(\''+item.getMessageShort(40).strip()+'\')'" i18n:attributes="title edit_news_deletetitle; alt edit_news_deletetitle" type="image" src="/img/delete.png"/>
                    </td>
                </tr>
                </tal:block>
            </tbody>
            <tfoot>
                <tr>
                    <th colspan="10"><tal:block tal:replace="python:str(len(items))"/> <tal:block i18n:translate="edit_news_entries"/></th>
                </tr>
            </tfoot>
        </table>
    </form>
</metal:block>